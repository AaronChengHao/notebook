支付系统：
---
支付架构：同步异步，支付路由，虚拟账户，手续费
风控系统：交易鉴权，身份、卡验证，白名单，黑名单
支付接入：数据加密
交易进行：超时处理，状态转换，通道分流
交易统计：返回码管理与映射，财务统计
对账管理：拉取，规范，对账，清结算
监控系统：前：通道状态，中：异常交易，异常返回码，后：成功率
测试系统：测试环境，MOCK
杂项系统：常用工具，通知报警

支付系统对账：
---
1. 下载对账文件（方式：FTP/HTTP）(时间)
2. 标准化处理（格式：txt/xml/cvs）
3. 本地对账准备：源库/从库/nosql
4. 两个账务数组对比：mapreduce
5. 差异数据修复(人工/后续)

加密
---
初始向量：在AES ecb模式加密时，加密时会将数据分成大小为密钥长度的块来分别加密，但数量足够多的明文块和密文块的对应可以轻松破解出密钥。所以引入初始向量对第一块加密，加密后的结果作为向量进行第二块加密，以此类推。初始向量要上送给解密方。

填充：在ECB或CBC模式下，将数据分块后，最后一块可能长度不足，这就需要填充，填充方式：
- 位填充：一个标识位 ‘1’，后续被填充位‘0’
- 字节填充：填充位 （N -1）个‘00’，最后填充N
- ISO填充：填充位（N-1）个随机字符，最后填充N
ACSII PLAINTEXT: buy
(IN HEX):        627579
INPUT BLOCK:     627579 '58' 'B3' '98' '9B' '05'
- PKCS7填充：需要共需要N个填充位，每个填充位都是N